module.exports=[42717,e=>{"use strict";var a=e.i(77136);let t=new a.InlineKeyboard().text("üß™ Cek IP Proxy","action_check_ip").row().text("üåê Buat VLESS","action_create_vless").text("üé≤ VLESS Random","action_random_vless").row().text("üìÑ List VLESS","action_list_vless").text("üìä All Status","action_all_status").row().text("üîç Cek Status VLESS","action_check_status_vless").text("üåç List Wildcard","action_list_wildcard").row().text("üîó Get Sub Link","action_get_sub_link").text("üìà Data Pemakaian","action_usage_data").row().text("üíù Donasi","action_donate").text("üõ† Admin Menu","action_admin_menu"),i=new a.InlineKeyboard().text("WS","method_ws").text("SNI","method_sni").row().text("WILDCARD","method_wildcard").row().text("‚¨ÖÔ∏è Kembali","menu_main"),s=new a.InlineKeyboard().text("‚öôÔ∏è Pengaturan API CF","admin_cf_settings").row().text("‚ûï Add Proxy","admin_add_proxy").text("üóë Del Proxy","admin_del_proxy").row().text("üìä Statistik & Monitor","admin_stats").row().text("‚¨ÖÔ∏è Kembali","menu_main"),r=new a.InlineKeyboard().text("üîê Akun CF VPN","admin_list_cf_vpn").row().text("üì° Akun CF Feeder","admin_cf_feeder").row().text("üì• Tambah Akun Baru","admin_add_cf_account").row().text("‚¨ÖÔ∏è Kembali","action_admin_menu"),n=new a.InlineKeyboard().text("VLESS","sub_type_vless").text("CLASH","sub_type_clash").row().text("‚¨ÖÔ∏è Kembali","menu_main"),o=new a.InlineKeyboard().text("WS","sub_method_ws").text("SNI","sub_method_sni").row().text("WILDCARD","sub_method_wildcard").row().text("‚¨ÖÔ∏è Kembali","menu_main");function d(e){let t=new a.InlineKeyboard;return e.forEach(e=>{t.text(`(${e.country}) ${e.name} ${e.flag}`,`select_server_${e.subdomain}`).row()}),t.text("‚¨ÖÔ∏è Kembali","menu_main"),t}function c(e){let t=new a.InlineKeyboard;return e.forEach(e=>{t.text(e,`select_wildcard_${e}`).row()}),t.text("‚¨ÖÔ∏è Kembali","menu_main"),t}let l=new a.InlineKeyboard().text("‚¨ÖÔ∏è Kembali","menu_main");e.s(["adminKeyboard",0,s,"backToMainKeyboard",0,l,"cfSettingsKeyboard",0,r,"generateServerListKeyboard",()=>d,"generateWildcardListKeyboard",()=>c,"mainMenuKeyboard",0,t,"methodKeyboard",0,i,"subLinkMethodKeyboard",0,o,"subLinkTypeKeyboard",0,n])},37037,e=>{"use strict";let a="https://api.cloudflare.com/client/v4";async function t(e,t,i,s){let r={"Content-Type":"application/json"};i.apiKey.startsWith("Bearer ")?r.Authorization=i.apiKey:(r["X-Auth-Email"]=i.email,r["X-Auth-Key"]=i.apiKey);let n=await fetch(`${a}${e}`,{method:t,headers:r,body:s?JSON.stringify(s):void 0}),o=await n.json();if(!o.success)throw Error(`CF API Error: ${o.errors[0]?.message||JSON.stringify(o.errors)}`);return o.result}async function i(e,t,i){let s=new FormData;s.append("metadata",JSON.stringify({main_module:"index.js",compatibility_date:"2023-01-01"})),s.append("index.js",new Blob([i],{type:"application/javascript+module"}));let r={};e.apiKey.startsWith("Bearer ")?r.Authorization=e.apiKey:(r["X-Auth-Email"]=e.email,r["X-Auth-Key"]=e.apiKey);let n=await fetch(`${a}/accounts/${e.accountId}/workers/scripts/${t}`,{method:"PUT",headers:r,body:s}),o=await n.json();if(!o.success)throw Error(`CF Upload Error: ${o.errors[0]?.message||JSON.stringify(o.errors)}`);return o.result}async function s(e,a,i,s,r){return t(`/accounts/${a}/workers/domains`,"PUT",e,{hostname:s,service:i,zone_id:r})}async function r(e,a,i,s){return t(`/zones/${a}/workers/routes`,"POST",e,{pattern:i,script:s})}async function n(e,a,i){return t(`/accounts/${e.accountId}/workers/scripts/${a}/schedules`,"PUT",e,[{cron:i[0]}])}async function o(e,a,i){let s=Object.entries(i).map(([e,a])=>({type:"plain_text",name:e,text:a}));return t(`/accounts/${e.accountId}/workers/scripts/${a}/settings`,"PATCH",e,{bindings:s})}e.s(["addWorkerDomain",()=>s,"addWorkerRoute",()=>r,"updateWorkerCron",()=>n,"updateWorkerEnv",()=>o,"uploadWorker",()=>i])},36942,e=>e.a(async(a,t)=>{try{var i=e.i(77136),s=e.i(42717),r=e.i(43793),n=e.i(37037),o=a([r]);function d(e){e.command("start",async e=>{await e.reply("Selamat datang di bot VLESS Worker.\n\nSilahkan pilih menu di bawah ini:",{reply_markup:s.mainMenuKeyboard})}),e.callbackQuery("action_create_vless",async e=>{let a=(await r.db.execute("SELECT * FROM workers WHERE type='vless'")).rows.map(e=>({country:e.country_code,flag:e.flag,name:e.worker_name,subdomain:e.subdomain}));if(0===a.length)return e.editMessageText("‚ö†Ô∏è Belum ada server yang tersedia. Hubungi Admin.",{reply_markup:s.mainMenuKeyboard});await e.editMessageText("Pilih server untuk membuat VLESS:",{reply_markup:(0,s.generateServerListKeyboard)(a)})}),e.callbackQuery("menu_main",async e=>{await e.editMessageText("Selamat datang di bot VLESS Worker.\n\nSilahkan pilih menu di bawah ini:",{reply_markup:s.mainMenuKeyboard})}),e.callbackQuery(/^select_server_(.+)$/,async e=>{let a=e.match[1],t=(await r.db.execute({sql:"SELECT * FROM workers WHERE subdomain = ?",args:[a]})).rows[0];e.session.temp={selectedServer:{subdomain:a,country:t.country_code,flag:t.flag,name:t.worker_name}},await e.editMessageText(`‚úÖ Server Terpilih: ${t.worker_name} ${t.flag}

Pilih metode inject:`,{reply_markup:s.methodKeyboard})}),e.callbackQuery("method_ws",async e=>{e.session.temp||(e.session.temp={}),e.session.temp.selectedMethod="ws",await e.reply("‚ö° Kirimkan BUG WS yang ingin digunakan."),await e.conversation.enter("inputBugConversation")}),e.callbackQuery(["method_sni","method_wildcard"],async e=>{let a="method_sni"===e.callbackQuery.data?"sni":"wildcard";e.session.temp||(e.session.temp={}),e.session.temp.selectedMethod=a;let t=(await r.db.execute("SELECT subdomain FROM workers WHERE type='vless'")).rows.map(e=>e.subdomain);await e.editMessageText(`Pilih salah satu subdomain untuk metode ${a.toUpperCase()}:`,{reply_markup:(0,s.generateWildcardListKeyboard)(t)})}),e.callbackQuery(/^select_wildcard_(.+)$/,async e=>{let a=e.match[1];await g(e,a)}),e.callbackQuery("action_admin_menu",async e=>{if(!c(e))return e.reply("‚õî Akses Ditolak.");await e.editMessageText("üõ† Admin Menu",{reply_markup:s.adminKeyboard})}),e.callbackQuery("admin_cf_settings",async e=>{c(e)&&await e.editMessageText("‚öôÔ∏è Pengaturan API CF",{reply_markup:s.cfSettingsKeyboard})}),e.callbackQuery("admin_add_proxy",async e=>{c(e)&&await e.conversation.enter("addProxyConversation")}),e.callbackQuery("admin_add_cf_account",async e=>{await e.conversation.enter("addCfAccountConversation")}),e.callbackQuery("admin_cf_feeder",async e=>{c(e)&&await e.conversation.enter("addFeederConversation")}),e.callbackQuery("action_check_ip",async e=>{if(e.chat){await e.editMessageText("‚è≥ Checking IP...",{reply_markup:s.backToMainKeyboard});try{let a=await fetch("https://api.ipify.org?format=json"),t=await a.json();await e.editMessageText(`üìç <b>Worker IP:</b> <code>${t.ip}</code>`,{parse_mode:"HTML",reply_markup:s.backToMainKeyboard})}catch(a){await e.editMessageText("‚ùå Gagal cek IP.",{reply_markup:s.backToMainKeyboard})}}}),e.callbackQuery("action_list_vless",async e=>{let a=await r.db.execute("SELECT worker_name, country_code, flag, subdomain FROM workers WHERE type='vless'");if(0===a.rows.length)return e.editMessageText("‚ö†Ô∏è Belum ada server.",{reply_markup:s.backToMainKeyboard});let t="üìÑ <b>List VLESS Server:</b>\n\n";a.rows.forEach((e,a)=>{t+=`${a+1}. ${e.flag} <b>${e.worker_name}</b>
   <code>${e.subdomain}</code>

`}),await e.editMessageText(t,{parse_mode:"HTML",reply_markup:s.backToMainKeyboard})}),e.callbackQuery("action_list_wildcard",async e=>{let a=await r.db.execute("SELECT subdomain FROM workers WHERE type='vless'");if(0===a.rows.length)return e.editMessageText("‚ö†Ô∏è Belum ada server.",{reply_markup:s.backToMainKeyboard});let t="üåç <b>List Domain Wildcard:</b>\n\n";a.rows.forEach(e=>{t+=`‚Ä¢ <code>${e.subdomain}</code>
`}),await e.editMessageText(t,{parse_mode:"HTML",reply_markup:s.backToMainKeyboard})}),e.callbackQuery("action_donate",async e=>{await e.editMessageText("üíù <b>Donasi Pengembangan Bot</b>\n\nSilahkan kontak admin: @garword",{parse_mode:"HTML",reply_markup:s.backToMainKeyboard})}),e.callbackQuery("action_usage_data",async e=>{await e.editMessageText("üìà <b>Data Pemakaian</b>\n\nFitur ini memerlukan integrasi GraphQL Cloudflare yang lebih dalam. Saat ini belum tersedia.",{parse_mode:"HTML",reply_markup:s.backToMainKeyboard})}),e.callbackQuery("action_get_sub_link",async e=>{await e.editMessageText("üîó Pilih Tipe Subscription:",{reply_markup:s.subLinkTypeKeyboard})}),e.callbackQuery(/^sub_type_(.+)$/,async e=>{let a=e.match[1];e.session.temp={subType:a},await e.editMessageText("üîó Pilih Metode:",{reply_markup:s.subLinkMethodKeyboard})}),e.callbackQuery(/^sub_method_(.+)$/,async e=>{e.match[1],e.session.temp?.subType,await e.editMessageText("‚ùå URL Bot belum diset di Database Settings. Gunakan menu Admin Feeder untuk set URL Bot output.",{reply_markup:s.backToMainKeyboard})}),e.callbackQuery("admin_list_cf_vpn",async e=>{if(!c(e))return;let a=await r.db.execute("SELECT email, account_id FROM cf_accounts");if(0===a.rows.length)return e.editMessageText("‚ö†Ô∏è Belum ada akun CF tersimpan.",{reply_markup:s.backToMainKeyboard});let t="üîê <b>List Akun Cloudflare:</b>\n\n";a.rows.forEach((e,a)=>{t+=`${a+1}. ${e.email}
   ID: <code>${e.account_id}</code>

`}),await e.editMessageText(t,{parse_mode:"HTML",reply_markup:s.backToMainKeyboard})}),e.callbackQuery("admin_del_proxy",async e=>{if(!c(e))return;let a=await r.db.execute("SELECT id, worker_name, subdomain FROM workers");if(0===a.rows.length)return e.editMessageText("‚ö†Ô∏è Tidak ada proxy untuk dihapus.",{reply_markup:s.backToMainKeyboard});let t=new i.InlineKeyboard;a.rows.forEach(e=>{t.text(`üóë ${e.worker_name}`,`del_proxy_${e.id}`).row()}),t.text("‚¨ÖÔ∏è Batal","menu_main"),await e.editMessageText("Pilih Proxy yang akan dihapus (Hanya DB):",{reply_markup:t})}),e.callbackQuery(/^del_proxy_(.+)$/,async e=>{if(!c(e))return;let a=e.match[1];await r.db.execute({sql:"DELETE FROM workers WHERE id = ?",args:[a]}),await e.editMessageText("‚úÖ Proxy berhasil dihapus dari Database.",{reply_markup:s.backToMainKeyboard})})}function c(e){return(process.env.ADMIN_IDS?.split(",").map(Number)||[]).includes(e.from?.id||0)}async function l(e,a,t){a&&await e.api.deleteMessage(e.chat?.id,a).catch(()=>{}),t&&await e.api.deleteMessage(e.chat?.id,t).catch(()=>{})}async function m(e,a){let t=await a.reply("üìß Masukkan Email Cloudflare Anda:"),i=await e.wait(),o=i.message?.text;if(i.message?.message_id&&await a.api.deleteMessage(a.chat?.id,i.message.message_id).catch(()=>{}),!o||"batal"===o.toLowerCase()||"cancel"===o.toLowerCase())return void await l(a,void 0,t.message_id);let d=await a.reply("üîë Masukkan Global API Key / Token:"),c=await e.wait(),m=c.message?.text;if(c.message?.message_id&&await a.api.deleteMessage(a.chat?.id,c.message.message_id).catch(()=>{}),!m||"batal"===m.toLowerCase()||"cancel"===m.toLowerCase())return void await l(a,void 0,d.message_id);let u=await a.reply("üÜî Masukkan Account ID:"),p=await e.wait(),g=p.message?.text;if(p.message?.message_id&&await a.api.deleteMessage(a.chat?.id,p.message.message_id).catch(()=>{}),!g||"batal"===g.toLowerCase()||"cancel"===g.toLowerCase())return void await l(a,void 0,u.message_id);if(o&&m&&g){let t=await a.reply("‚è≥ Memverifikasi & Mendaftarkan Akun...");try{let i=(await r.db.execute({sql:"INSERT INTO cf_accounts (email, api_key, account_id, owner_id) VALUES (?, ?, ?, ?) RETURNING id",args:[o,m,g,a.from?.id||0]})).rows[0].id;await a.api.editMessageText(a.chat?.id,t.message_id,"üöÄ Sedang men-deploy VLESS Worker ke akun Anda...");let d=`
            import { connect } from "cloudflare:sockets";
            export default {
              async fetch(request, env, ctx) {
                 const upgrade = request.headers.get("Upgrade");
                 if(upgrade === "websocket") return new Response(null, { status: 101 });
                 return new Response("VLESS Active", { status: 200 });
              }
            };`,c=`vless-${a.from?.id}-${Math.floor(1e3*Math.random())}`,l={email:o,apiKey:m,accountId:g};await (0,n.uploadWorker)(l,c,d);let u=`${c}.${g.substring(0,4)}.workers.dev`,p="ID",y="üáÆüá©";await a.api.deleteMessage(a.chat?.id,t.message_id).catch(()=>{}),await a.reply("üåê Apakah Anda ingin menggunakan **Custom Domain** sendiri? (Support Wildcard/SNI).\n\nKetik nama domain (misal: `vip.domainku.com`) atau ketik **skip** untuk menggunakan default.");let w=await e.wait();if(w.message?.message_id&&await a.api.deleteMessage(a.chat?.id,w.message.message_id).catch(()=>{}),w.message?.text&&"skip"!==w.message.text.toLowerCase()){let t=w.message.text.toLowerCase(),i=await a.reply(`üÜî Kirimkan **Zone ID** untuk domain ${t}:`),s=await e.wait(),r=s.message?.text;if(s.message?.message_id&&await a.api.deleteMessage(a.chat?.id,s.message.message_id).catch(()=>{}),r){await a.api.editMessageText(a.chat?.id,i.message_id,"‚öôÔ∏è Mengikat Custom Domain & Routing Wildcard...");try{await (0,n.addWorkerDomain)(l,g,c,t,r);try{await (0,n.addWorkerRoute)(l,r,`*.${t}/*`,c)}catch(e){}u=t,p="US",y="üá∫üá∏",await a.api.editMessageText(a.chat?.id,i.message_id,`‚úÖ Domain ${t} berhasil diikat!`)}catch(e){await a.api.editMessageText(a.chat?.id,i.message_id,`‚ö†Ô∏è Gagal BIND Domain: ${e.message}. Tetap menggunakan subdomain standar.`)}}}await r.db.execute({sql:"INSERT INTO workers (subdomain, account_id, worker_name, type, country_code, flag) VALUES (?, ?, ?, 'vless', ?, ?)",args:[u,i,c,p,y]}),await a.reply(`‚úÖ Selesai! Worker Anda aktif: ${u}.
Siap digunakan untuk WS/SNI/Wildcard Pribadi.`,{reply_markup:s.backToMainKeyboard})}catch(e){await a.reply(`‚ùå Gagal: ${e.message}`,{reply_markup:s.backToMainKeyboard})}}else await a.reply("‚ö†Ô∏è Gagal, data tidak lengkap.",{reply_markup:s.backToMainKeyboard})}async function u(e,a){await a.reply("üÜî Masukkan **Account ID Cloudflare** target deployment:");let t=await e.wait(),i=t.message?.text;if(t.message?.message_id&&await a.api.deleteMessage(a.chat?.id,t.message.message_id).catch(()=>{}),!i)return;await a.reply("üìù Masukkan **Nama Worker** (ex: vless-sg1):");let o=await e.wait(),d=o.message?.text||`vless-${Date.now()}`;o.message?.message_id&&await a.api.deleteMessage(a.chat?.id,o.message.message_id).catch(()=>{});let c=null,l=0;try{let e=await r.db.execute({sql:"SELECT id, email, api_key FROM cf_accounts WHERE account_id = ? LIMIT 1",args:[i]});if(!(e.rows.length>0))return a.reply("‚ö†Ô∏è Akun ID tidak ditemukan di database. Tambahkan akun dulu di menu Admin.",{reply_markup:s.backToMainKeyboard});{let a=e.rows[0];l=a.id,c={email:a.email,apiKey:a.api_key,accountId:i}}}catch(e){return a.reply("‚ö†Ô∏è DB Error.",{reply_markup:s.backToMainKeyboard})}let m=`${d}.${i.substring(0,4)}.workers.dev`,u="ID",p="üáÆüá©";await a.reply("üåê Gunakan **Custom Domain**? (Ketik domain atau 'skip'):");let g=await e.wait();if(g.message?.message_id&&await a.api.deleteMessage(a.chat?.id,g.message.message_id).catch(()=>{}),g.message?.text&&"skip"!==g.message.text.toLowerCase()){let t=g.message.text.toLowerCase(),s=await a.reply(`üÜî Kirimkan **Zone ID** untuk ${t}:`),r=await e.wait(),o=r.message?.text;if(r.message?.message_id&&await a.api.deleteMessage(a.chat?.id,r.message.message_id).catch(()=>{}),o){await a.api.editMessageText(a.chat?.id,s.message_id,"‚öôÔ∏è Binding Custom Domain & Routing Wildcard...");try{await (0,n.addWorkerDomain)(c,i,d,t,o);try{await (0,n.addWorkerRoute)(c,o,`*.${t}/*`,d)}catch(e){}m=t,u="SG",p="üá∏üá¨",await a.api.editMessageText(a.chat?.id,s.message_id,`‚úÖ Routing Wildcard (*.${t}) Berhasil!`)}catch(e){await a.api.editMessageText(a.chat?.id,s.message_id,`‚ö†Ô∏è Gagal bind domain: ${e.message}`)}}}try{let e=await a.reply(`‚è≥ Deploying ${d}...`),t=`
        export default {
          async fetch(request) { return new Response("VLESS Admin Node"); }
        };`;await (0,n.uploadWorker)(c,d,t),await r.db.execute({sql:"INSERT INTO workers (subdomain, account_id, worker_name, type, country_code, flag) VALUES (?, ?, ?, 'vless', ?, ?)",args:[m,l,d,u,p]}),await a.api.editMessageText(a.chat?.id,e.message_id,`‚úÖ Proxy Admin Siap!
Domain: ${m}
Wildcard/SNI: Aktif.`,{reply_markup:s.backToMainKeyboard})}catch(e){await a.reply(`‚ùå Error: ${e.message}`,{reply_markup:s.backToMainKeyboard})}}async function p(e,a){let t=await e.wait();if(!t.message?.text)return;t.message?.message_id&&await a.api.deleteMessage(a.chat?.id,t.message.message_id).catch(()=>{});let i=t.message.text;a.session.temp&&(a.session.temp.bug=i),await g(a,i)}async function g(e,a){let t=e.session.temp;if(!t||!t.selectedServer)return;let i=await e.reply("üîÑ Generating Config..."),{subdomain:r,country:n,flag:o,name:d}=t.selectedServer,c=t.selectedMethod,l=r,m=r,u=r,p="/",g=`${o} ${d}`;"ws"===c?(l=a,m=r,u=r,p=`/${r}-443`):"sni"===c?(l=r,m=a,u=a):"wildcard"===c&&(l=a,u=m=`${a}.${r}`);let y=(globalThis.crypto?globalThis.crypto.randomUUID():"USER_UUID_PLACEHOLDER")||"UUID-GENERATOR-FAILED",w=`vless://${y}@${l}:443?encryption=none&security=tls&sni=${m}&type=ws&host=${u}&path=${encodeURIComponent(p)}#${encodeURIComponent(g)}`,k=`vless://${y}@${l}:80?encryption=none&security=none&type=ws&host=${u}&path=${encodeURIComponent(p)}#${encodeURIComponent(g)}`,_=`
- name: ${g}
  server: ${l}
  port: 443
  type: vless
  uuid: ${y}
  cipher: none
  tls: true
  skip-cert-verify: true
  network: ws
  servername: ${m}
  ws-opts:
    path: ${p}
    headers:
      Host: ${u}
    udp: true
`.trim(),b=`
<b>${g}</b>
Method: ${c?.toUpperCase()}

<b>VLESS TLS:</b>
<code>${w}</code>

<b>VLESS NTLS:</b>
<code>${k}</code>

<b>CLASH:</b>
<code>${_}</code>
    `.trim();try{await e.api.editMessageText(e.chat.id,i.message_id,b,{parse_mode:"HTML",reply_markup:s.backToMainKeyboard})}catch(a){await e.api.editMessageText(e.chat.id,i.message_id,`‚ùå Error: ${a.message}`,{reply_markup:s.backToMainKeyboard})}}[r]=o.then?(await o)():o;let k=`
export default {
    async scheduled(event, env, ctx) {
        console.log("Cron Triggered");
        const botUrl = env.BOT_API_URL;
        const secret = env.BOT_SECRET;

        if (!botUrl) {
            console.error("BOT_API_URL not set");
            return;
        }

        const url = \`\${botUrl}?action=check_proxies&secret=\${secret}\`;
        console.log(\`Fetching \${url}...\`);

        try {
            const resp = await fetch(url);
            console.log(\`Response: \${resp.status}\`);
        } catch (e) {
            console.error("Fetch Error:", e);
        }
    },
    
    async fetch(request) {
        return new Response("Monitor Worker Active. Use Cron Trigger.");
    }
};
`;async function y(e,a){let t=await a.reply("üìß Masukkan Email Cloudflare (Feeder):"),i=await e.wait(),o=i.message?.text;if(i.message?.message_id&&await a.api.deleteMessage(a.chat?.id,i.message.message_id).catch(()=>{}),!o||"batal"===o.toLowerCase())return void await l(a,void 0,t.message_id);await a.reply("üîë Masukkan Global API Key / Token:");let d=await e.wait(),c=d.message?.text;d.message?.message_id&&await a.api.deleteMessage(a.chat?.id,d.message.message_id).catch(()=>{}),await a.reply("üÜî Masukkan Account ID Cloudflare:");let m=await e.wait(),u=m.message?.text;m.message?.message_id&&await a.api.deleteMessage(a.chat?.id,m.message.message_id).catch(()=>{}),await a.reply("üì¢ Masukkan ID Channel Telegram untuk Notifikasi (Contoh: -100xxxxxxx):");let p=await e.wait(),g=p.message?.text;p.message?.message_id&&await a.api.deleteMessage(a.chat?.id,p.message.message_id).catch(()=>{}),await a.reply("üåê Masukkan URL Project Vercel Anda (Contoh: https://my-bot.vercel.app):");let y=await e.wait(),w=y.message?.text;if(y.message?.message_id&&await a.api.deleteMessage(a.chat?.id,y.message.message_id).catch(()=>{}),!o||!c||!u||!g||!w)return a.reply("‚ùå Input tidak lengkap. Batal.",{reply_markup:s.backToMainKeyboard});w.endsWith("/")&&(w=w.slice(0,-1)),w.includes("/api/webhook")||(w+="/api/webhook");let _={email:o,apiKey:c,accountId:u},b="vless-monitor-feeder",h=Math.random().toString(36).substring(7),x=await a.reply(`‚è≥ Deploying Monitor Worker ke Cloudflare: ${b}...`);try{await (0,n.uploadWorker)(_,b,k),await a.api.editMessageText(a.chat?.id,x.message_id,"‚öôÔ∏è Setting Environment Variables..."),await (0,n.updateWorkerEnv)(_,b,{BOT_API_URL:w,BOT_SECRET:h}),await a.api.editMessageText(a.chat?.id,x.message_id,"‚è∞ Setting Cron Trigger (Setiap 5 menit)..."),await (0,n.updateWorkerCron)(_,b,["*/5 * * * *"]),await r.db.execute({sql:"INSERT OR REPLACE INTO settings (key, value) VALUES ('monitor_channel_id', ?)",args:[g]}),await r.db.execute({sql:"INSERT OR REPLACE INTO settings (key, value) VALUES ('monitor_secret', ?)",args:[h]}),await a.api.editMessageText(a.chat?.id,x.message_id,"‚úÖ Feeder Berhasil Di-setup!\nWorker akan memanggil bot setiap 5 menit untuk cek proxy.",{reply_markup:s.backToMainKeyboard})}catch(e){await a.reply(`‚ùå Gagal Setup Feeder: ${e.message}`,{reply_markup:s.backToMainKeyboard})}}async function w(e){let a=await r.db.execute("SELECT value FROM settings WHERE key = 'monitor_channel_id'"),t=a.rows[0]?.value;if(!t&&process.env.CHANNEL_ID&&(t=process.env.CHANNEL_ID),!t)return void console.log("No Monitor Channel ID set.");let i=await r.db.execute("SELECT * FROM workers WHERE type = 'vless'");if(0!==i.rows.length)for(let a of i.rows){let i=a.subdomain,s=a.worker_name,r=a.flag;try{let e=new AbortController,a=setTimeout(()=>e.abort(),8e3),t=await fetch(`https://${i}`,{method:"GET",signal:e.signal});clearTimeout(a),t.ok}catch(n){let a=`‚ö†Ô∏è <b>PROXY ALERT</b> ‚ö†Ô∏è

Name: ${s}
Domain: ${i} ${r}
Status: üî¥ DOWN / UNREACHABLE
Error: ${n.message}`;try{await e.api.sendMessage(t,a,{parse_mode:"HTML"})}catch(e){console.error(`Failed to send alert to ${t}:`,e)}}}}e.s(["addCfAccountConversation",()=>m,"addFeederConversation",()=>y,"addProxyConversation",()=>u,"checkProxiesAndNotify",()=>w,"inputBugConversation",()=>p,"setupHandlers",()=>d]),t()}catch(e){t(e)}},!1)];

//# sourceMappingURL=src_fad20de5._.js.map